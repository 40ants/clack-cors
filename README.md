<a id="x-28CLACK-CORS-DOCS-2FINDEX-3A-40README-2040ANTS-DOC-2FLOCATIVES-3ASECTION-29"></a>

# clack-cors - A Clack middleware to set CORS related HTTP headers.

<a id="clack-cors-asdf-system-details"></a>

## CLACK-CORS ASDF System Details

* Version: 0.1.0

* Description: A Clack middleware to set `CORS` related `HTTP` headers.

* Licence: Unlicense

* Author: Alexander Artemenko <svetlyak.40wt@gmail.com>

* Homepage: [https://40ants.com/clack-cors/][5c32]

* Bug tracker: [https://github.com/40ants/clack-cors/issues][b14f]

* Source control: [GIT][74db]

* Depends on: [alexandria][8236], [log4cl][7f8b], [serapeum][c41d]

[![](https://github-actions.40ants.com/40ants/clack-cors/matrix.svg?only=ci.run-tests)][1700]

![](http://quickdocs.org/badge/clack-cors.svg)

<a id="x-28CLACK-CORS-DOCS-2FINDEX-3A-3A-40INSTALLATION-2040ANTS-DOC-2FLOCATIVES-3ASECTION-29"></a>

## Installation

You can install this library from Quicklisp, but you want to receive updates quickly, then install it from Ultralisp.org:

```
(ql-dist:install-dist "http://dist.ultralisp.org/"
                      :prompt nil)
(ql:quickload :clack-cors)
```
<a id="x-28CLACK-CORS-DOCS-2FINDEX-3A-3A-40USAGE-2040ANTS-DOC-2FLOCATIVES-3ASECTION-29"></a>

## Usage

<a id="x-28CLACK-CORS-3AMAKE-CORS-MIDDLEWARE-20FUNCTION-29"></a>

### [function](9969) `clack-cors:make-cors-middleware` app &key (allowed-origin \*default-allowed-origin\*) (allowed-headers \*default-allowed-headers\*) (error-response \*default-error-response\*)

Returns a Clack middleware which can be used to add `CORS` `HTTP` headers to response.

By default, it adds:

* Access-Control-Allow-Origin: *

* Access-Control-Allow-Headers: Authorization

But you can pass arguments `ALLOWED-ORIGIN` and `ALLOWED-HEADERS` to change this behaviour.

Also, you can provide a `ERROR-RESPONSE` argument which will be used as response
in case if original `APP` returns response other than a list of three items. This argument
should be a list like this:

```
(list 500
     (list :Content-Type "application/json")
     (list "{\"code\": -1, \"message\": \"Unhandled error.\"}"))
```
All arguments can be given as a function of one argument, in this case a function
will be called with Lack's `env` plist. Most useful keys in this plist are
`:REQUEST-METHOD` and `:REQUEST-URI`.

<a id="x-28CLACK-CORS-3A-2ADEFAULT-ALLOWED-ORIGIN-2A-20-28VARIABLE-29-29"></a>

### [variable](7601) `clack-cors:*default-allowed-origin*` "*"

Default value to return as `Access-Control-Allow-Origin` `HTTP` header.

<a id="x-28CLACK-CORS-3A-2ADEFAULT-ALLOWED-HEADERS-2A-20-28VARIABLE-29-29"></a>

### [variable](1bfb) `clack-cors:*default-allowed-headers*` "Authorization"

Default value to return as `Access-Control-Allow-Origin` `HTTP` header.

<a id="x-28CLACK-CORS-3A-2ADEFAULT-ERROR-RESPONSE-2A-20-28VARIABLE-29-29"></a>

### [variable](b2de) `clack-cors:*default-error-response*` (500 (:CONTENT-TYPE "application/json")
 ("{\"code\": -1, \"message\": \"Unhandled error.\"}"))

Default value to return if main app will not return a list of three items.


[5c32]: https://40ants.com/clack-cors/
[74db]: https://github.com/40ants/clack-cors
[1700]: https://github.com/40ants/clack-cors/actions
[7601]: https://github.com/40ants/clack-cors/blob/ba1ebdbaa0893a68aa790dd8ade0d5273568dffb/src/core.lisp#L17
[1bfb]: https://github.com/40ants/clack-cors/blob/ba1ebdbaa0893a68aa790dd8ade0d5273568dffb/src/core.lisp#L20
[b2de]: https://github.com/40ants/clack-cors/blob/ba1ebdbaa0893a68aa790dd8ade0d5273568dffb/src/core.lisp#L23
[9969]: https://github.com/40ants/clack-cors/blob/ba1ebdbaa0893a68aa790dd8ade0d5273568dffb/src/core.lisp#L61
[b14f]: https://github.com/40ants/clack-cors/issues
[8236]: https://quickdocs.org/alexandria
[7f8b]: https://quickdocs.org/log4cl
[c41d]: https://quickdocs.org/serapeum

* * *
###### [generated by [40ANTS-DOC](https://40ants.com/doc/)]
